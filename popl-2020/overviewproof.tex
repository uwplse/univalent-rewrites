Lemma rev_app_distr {A : Type} :
  $\forall$ (x y : list A), rev (x ++ y) = rev y ++ rev x.
Proof.
  intros x y. revert y. induction x as [a l IHl|].
  - intro y0. simpl.
    rewrite (IHl y0). simpl. rewrite (app_assoc (rev y0) (rev l) (a::[])). reflexivity.
  - intro y0. induction y0 as [a l IHl|].
    + simpl. rewrite (app_nil_r (rev l) (a::[])). reflexivity.
    + reflexivity.
Qed.
