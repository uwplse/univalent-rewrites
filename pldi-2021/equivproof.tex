swap$\phantom{^{2}}$T (l : Old.list T) : New.list T :=(@\vspace{-0.04cm}@)
  Old.list_rect T (fun (l : Old.list T) => New.list T)(@\vspace{-0.04cm}@)
    New.nil(@\vspace{-0.04cm}@)
    (fun (t : T) _ (IHl : New.list T) =>(@\vspace{-0.04cm}@)
      New.cons T t IHl)(@\vspace{-0.04cm}@)
    l.(@\vspace{-0.04cm}@)
(@\vspace{-0.04cm}@)
Lemma section: $\forall$ T (l : Old.list T),(@\vspace{-0.04cm}@)
  swap$^{-1}$ T (swap T l) = l.(@\vspace{-0.04cm}@)
Proof.(@\vspace{-0.04cm}@)
  intros T l. symmetry. induction l as [ |a l0 H].(@\vspace{-0.04cm}@)
  - auto.(@\vspace{-0.04cm}@)
  - simpl. rewrite $\leftarrow$ H. auto.(@\vspace{-0.04cm}@)
Qed.

swap$^{-1}$ T (l : New.list T) : Old.list T :=(@\vspace{-0.04cm}@)
  New.list_rect T (fun (l : New.list T) => Old.list T)(@\vspace{-0.04cm}@)
    (fun (t : T) _ (IHl : Old.list T) =>(@\vspace{-0.04cm}@)
      Old.cons T t IHl)(@\vspace{-0.04cm}@)
    Old.nil(@\vspace{-0.04cm}@)
    l.(@\vspace{-0.04cm}@)
(@\vspace{-0.04cm}@)
Lemma retraction: $\forall$ T (l : New.list T),(@\vspace{-0.04cm}@)
  swap T (swap$^{-1}$ T l) = l.(@\vspace{-0.04cm}@)
Proof.(@\vspace{-0.04cm}@)
  intros T l. symmetry. induction l as [t l0 H| ].(@\vspace{-0.04cm}@)
  - simpl. rewrite $\leftarrow$ H. auto.(@\vspace{-0.04cm}@)
  - auto.(@\vspace{-0.04cm}@)
Qed.
